<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Slot Machine</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=2.0">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="./styles/style.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="./dist/jquery.slotmachine.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"
    type="text/css" />

  <script src="dist/money.js"></script>
  <script src="./dist/register.js"></script>
  <script src="dist/confetti.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="./dist/slotmachine.js"></script>
  <script src="./dist/bet.js"></script>
  <script src="./dist/jquery.slotmachine.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js"
    integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+"
    crossorigin="anonymous"></script>

</head>

<body>
  <div class="header-line" id="cont"></div>



  <!-- Intro -->
  <header>
    <h1>CASINO SLOTMACHINE</h1>
  </header>

  <div id="randomize">
    <div class="container machines">
      <div class="row machines">
        <div class="col-sm-4 machines">
          <div class="machines">
            <div id="machine1" class="randomizeMachine machines">
              <div><img src="img/slot1.png" /></div>
              <div><img src="img/slot2.png" /></div>
              <div><img src="img/slot3.png" /></div>
              <div><img src="img/slot4.png" /></div>
              <div><img src="img/slot5.png" /></div>
              <div><img src="img/slot6.png" /></div>
            </div>
          </div>
        </div>

        <div class="col-sm-4 machines">
          <div class="machines">
            <div id="machine2" class="randomizeMachine machines">
              <div><img src="img/slot1.png" /></div>
              <div><img src="img/slot2.png" /></div>
              <div><img src="img/slot3.png" /></div>
              <div><img src="img/slot4.png" /></div>
              <div><img src="img/slot5.png" /></div>
              <div><img src="img/slot6.png" /></div>
            </div>
          </div>
        </div>

        <div class="col-sm-4 machines machines">
          <div class="machines">
            <div id="machine3" class="randomizeMachine machines">
              <div class="machines"><img src="img/slot1.png" /></div>
              <div class="machines"><img src="img/slot2.png" /></div>
              <div class="machines"><img src="img/slot3.png" /></div>
              <div class="machines"><img src="img/slot4.png" /></div>
              <div class="machines"><img src="img/slot5.png" /></div>
              <div class="machines"><img src="img/slot6.png" /></div>
            </div>
          </div>
        </div>

        <div class="btn-group btn-group-justified machines" role="group">
          <h5 style="margin-top: 10px; font-size: 30px;">Current balance: </h5>
          <div id="balance" class="machines" style="margin-right: 100px; margin-top: 10px; font-size: 30px;"></div>
          <h5 style="margin-right: 10px; margin-top: 10px; font-size: 30px;">Place your bet!</h5>
          <div id="bet" class="machines" style="margin-right: 100px"></div>
          <button id="randomizeButton" type="button" class="btn btn-danger btn-lg machines"
            disabled="true">Spin</button>
          <!--Modal-->
          <div id="myModal" class="modal col-sm-4 machines" style="margin-top: 15%; margin-left:33.5%;">
            <div class="modal-content machines" style="text-align: center;">
              <div class="modal-header machines" style="background-color: gold; text-align: center; display: block;">
                <span class="close machines" id="close_btn">&times;</span>
                <div id="win_text" class="machines"></div>
              </div>
              <div class="modal-body machines">
                <div id="Price_money" class="machines"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
  <script id="codeScript2">
    const btn = document.querySelector('#randomizeButton');
    const results = {
      machine1: document.querySelector('#machine1Result'),
      machine2: document.querySelector('#machine2Result'),
      machine3: document.querySelector('#machine3Result')
    };
    var ind = 0;
    const start_money = 100;
    this.balance = start_money;
    const el1 = document.querySelector('#machine1');
    const el2 = document.querySelector('#machine2');
    const el3 = document.querySelector('#machine3');
    const machine1 = new SlotMachine(el1, { _active: 0 }, 1, ind);
    const machine2 = new SlotMachine(el2, { active: 1 }, 2, ind);
    const machine3 = new SlotMachine(el3, { active: 2 }, 3, ind);
    const register = new Register();
    const result = new Money();
    this.container = document.getElementById("bet");
    this.container_balance = document.getElementById("balance")
    this.bal_html = document.createElement("h5")
    this.bal_html.style="font-size:30px;"
    this.bal_html.innerText = `${this.balance}kr`;
    this.container_balance.appendChild(this.bal_html);
    const bet = new Bet(this.container);

    this.user_id = prompt("Please enter your id:");
    //start the timer
    startTimer()

    function onComplete(active) {
    }

    function startTimer() {
      this.seconds = 0;
      //Start the timer
      this.timer = setInterval(function () { this.seconds += 0.1; }, 100);
    }


    // Get the modal
    var modal = document.getElementById('myModal');

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    //Get the h2 tag with the header when you shuffle
    var price_header = document.getElementById('win_text');

    //Get the p tag with the content of what you win
    var price_text = document.getElementById('Price_money')

    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
      /*modal.style.display = "none";
      stopConfetti();*/
      bet.able();
      //start the timer
      startTimer()
      if (ind == 20) {
        //Shows a different modal when the user is at the last round
        ind += 1;
        result.Win(this.balance, 21, price_header, price_text, this.user_id);
        modal.style.display = "block";
      }
      else if (ind == 21) {
        //makes it impossible for the user to close the last modal
        modal.style.display = "block";
      }
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
      if (event.target == modal) {
        /*modal.style.display = "none";
        stopConfetti();*/
        bet.able();
        //start the timer
        startTimer()
        if (ind == 20) {
          //Shows a different modal when the user is at the last round
          ind += 1;
          result.Win(this.balance, 21, price_header, price_text, this.user_id);
          modal.style.display = "block";
        }
        else if (ind == 21) {
          //makes it impossible for the user to close the last modal
          modal.style.display = "block";
        }
      }
    }
    function openModal() {
      //Here we get the result from the shuffle
      this.result_list = result.Win(bet.bet()[0], ind, price_header, price_text, this.user_id);
      //Adds the results of the shuffle to the balance
      this.balance += this.result_list[0];
      //Updates the html that shows the balance
      this.bal_html.innerText = `${this.balance}kr`;
      //Register the data from the user to our results.txt file
      register.StoreData(ind, this.result_list[1], this.balance, this.user_id, bet.bet()[1], this.exact_time);
      //Sets the amount of clicks to zero
      bet.setClickstoZero();
      //Show the modal window
      if (ind == 20) {
        ind += 1;
        result.Win(this.balance, 21, price_header, price_text, this.user_id);
        modal.style.display = "block";
      }
      bet.able();
      //start the timer
      startTimer()
    }

    btn.addEventListener('click', () => {
      this.exact_time = this.seconds;
      clearInterval(this.timer);
      //Unables the shoose bet buttons and the shuffle button
      bet.unable()
      btn.disabled = true;
      //Subtracts the bet from the balance
      this.balance = this.balance - bet.bet()[0];
      //Updates the html with the balance
      this.bal_html.innerText = `${this.balance}kr`;
      //Add 1 to the index so that we know which round we're at
      ind = ind + 1;
      //Starts the machines
      machine1.shuffle(5, onComplete);
      setTimeout(() => machine2.shuffle(5, onComplete), 500);
      setTimeout(() => machine3.shuffle(5, onComplete), 1000);
      //Starts the function that shows the modal window and more
      setTimeout(() => openModal(5, onComplete), 3000);
    });
  </script>

  <footer>
    <div class="content">
    </div>
  </footer>


</body>

</html>